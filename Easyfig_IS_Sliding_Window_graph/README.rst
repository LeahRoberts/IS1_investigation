EasyFig IS1 Sliding Window Graph
=================================

A python script generated to count the number of gene features (eg. IS1) within a predefined window (eg. 10,000 bp), and to then iteratively move across the genome and generate a numerical list of the desired gene feature in each region throughout. 

Editing the input embl file
------------------------------

The script works by parsing an embl whole genome file and identifying gene features of a particular key, for example: 

* CDS
* mobile_element
* exon
* etc. 

For this reason, all of the gene features that you want to count need to be annotated so that their 'key' is unique and consistent between all desired gene features. 
For example, in order to count only IS1 in the EC958 embl file, the IS1 were manually annotated so that their key was 'operon'. This key is unique (i.e. not represented by any other gene feature in the EC958 embl file) and was consistent across all IS1. 

The embl file can be edited using the Artemis Genome Browser (http://www.sanger.ac.uk/resources/software/artemis/). 


How-to: Run Me
---------------

Some features of the script may need to be changed based on the desired output of the user. These include:

* The window size (currently set at 10,000 bp)
* The 'sliding' size (i.e. how many base pairs the script will move across the genome, currently set at 100 bp)
* The desired gene feature to be counted (Currently set at 'operon')

To run the script, the embl genome file needs to be in a folder called "Genomes".

While in the directory above "Genomes", type the command::

  $ python create_sliding_window_graph.py
  
The script will print progress results while running.

Output
-------

The script will generate a results.txt file which will contain the window start and end position, as well as the number of genes features within that window. For example::

  window_start,window_end,number_of_features
  1,10001,2
  2,10002,2
  etc.

Easyfig requires only the number of features at each position without the location. This can easily be generated by parsing the results.txt file::

  cat results.txt | cut -f3 -d, > feature_counts_only.txt
  
Example Files
--------------

All of the files used to generate a sliding window graph for ST131 IS1 throughout the ST131 chromosome (modelled using EC958) are available in the References folder. These include:

1. The embl file with all IS1 appropriately annotated (in the Genomes folder)
2. Example output from the python script - IS_count.csv representing raw output from the script, and IS_count_only.txt representing just the feature numbers as would be used in generating a graph in EasyFig
3. Two example EasyFig figures, in png and svg format

